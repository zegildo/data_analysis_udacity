data <- read.dta(choose.files())
library(foreign)
data <- read.dta(choose.files())
source('~/.active-rstudio-document', encoding = 'UTF-8', echo=TRUE)
library(psych)
install.packages('psych')
list.of.packages <- c("ggplot2", "fmsb", "psych")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
?pairs.panel
pairs.panel?
> pairs.panels(sat.d2,bg=c("yellow","blue")[(d2 > 25)+1],pch=21,stars=TRUE)
?pairs()
getwd()
setwd('/Cursos/R/estudos/scripts/final_project/rmd')
getwd()
setwd('C:/Users/usaurio/Documents/Cursos/R/estudos/scripts/final_project/rmd')
getwd()
#read files
setwd('~/Cursos/R/estudos/scripts/final_project/data')
red_wines <- read.csv(file = 'wineQualityReds.csv')
white_wines <- read.csv(file = 'wineQualityWhites.csv')
list.of.packages <- c("ggplot2", "fmsb", "psych")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
dim(white_wines)
summary(white_wines)
dim(white_wines)
summary(white_wines)
library(ggplot2)
library(tidyverse)
#merge red and white wines in a single dataset
red_wines$class <- 'RED'
white_wines$class <- 'WHITE'
all_wines <- rbind(red_wines, white_wines)
all_wines$X <- NULL
all_wines %>%
pivot_longer(-class) %>%
ggplot(aes(x=value, y=class, col=class)) +
geom_boxplot() +
facet_wrap(~name, scales = "free_x") +
labs(x="Variables", y="classes", color = "Legend")
library(fmsb)
radar_max_min <- rbind(
all_wines %>% summarise_if(is.numeric, max),
all_wines %>% summarise_if(is.numeric, min)
)
#red white wines
red_white_wines <- all_wines %>%
group_by(class) %>%
summarise_if(is.numeric, median)
red_white_wines$class <- NULL
attr(red_white_wines, "row.names") <- c('Red Wines', 'White Wines')
radar_data <- rbind(radar_max_min, red_white_wines)
# Color vector
colors_border <- c(rgb(0.8,0.2,0.5,0.9),
rgb(0.7,0.5,0.1,0.9)
)
colors_in <- c(rgb(0.8,0.2,0.5,0.4),
rgb(0.7,0.5,0.1,0.4)
)
# plot with default options:
radarchart(radar_data,
axistype=1,
#custom polygon
pcol=colors_border,
pfcol=colors_in,
plwd=4,
plty=1,
#grid
cglcol="grey",
cglty=1,
axislabcol="grey",
#custom labels
vlcex=1
)
# Add a legend
legend(x=1,
y=1,
legend = rownames(radar_data[-c(1,2),]),
bty = "n",
pch=20 ,
col=colors_in ,
text.col = "grey",
cex=1,
pt.cex=3)
red_wine_max_min <- rbind(
red_wines %>% summarise_if(is.numeric, max),
red_wines %>% summarise_if(is.numeric, min)
)
best_red_wines <- filter(red_wines, quality == max(quality))%>%                    summarise_if(is.numeric, median)
attr(best_red_wines, "row.names") <- c('Best Red Wine')
worse_red_wines <- filter(red_wines, quality == min(quality))%>%                    summarise_if(is.numeric, median)
attr(worse_red_wines, "row.names") <- c('Worst Red Wine')
red_wines_best_worst <- rbind(red_wine_max_min,
best_red_wines,
worse_red_wines)
# Color vector
colors_border <- c(rgb(0.8,0.2,0.5,0.9),
rgb(0.3,0.3,0.3,0.9)
)
colors_in <- c(rgb(0.8,0.2,0.5,0.4),
rgb(0.3,0.3,0.3,0.4)
)
# plot with default options:
red_wines_best_worst$X <- NULL
radarchart(red_wines_best_worst,
axistype=1,
#custom polygon
pcol=colors_border,
pfcol=colors_in,
plwd=4,
plty=1,
#grid
cglcol="grey",
cglty=1,
axislabcol="grey",
#custom labels
vlcex=1
)
# Add a legend
legend(x=1,
y=1,
legend = rownames(red_wines_best_worst[-c(1,2),]),
bty = "n",
pch=20 ,
col=colors_in ,
text.col = "grey",
cex=1,
pt.cex=3)
white_wine_max_min <- rbind(
white_wines %>% summarise_if(is.numeric, max),
white_wines %>% summarise_if(is.numeric, min)
)
best_white_wines <- filter(white_wines, quality == max(quality))%>%
summarise_if(is.numeric, median)
attr(best_white_wines, "row.names") <- c('Best White Wine')
worse_white_wines <- filter(white_wines, quality == min(quality))%>%                    summarise_if(is.numeric, median)
attr(worse_white_wines, "row.names") <- c('Worst White Wine')
white_wines_best_worst <- rbind(white_wine_max_min,
best_white_wines,
worse_white_wines)
white_wines_best_worst$X <- NULL
# Color vector
colors_border <- c(rgb(0.7,0.5,0.1,0.9),
rgb(0.3,0.3,0.3,0.9)
)
colors_in <- c(rgb(0.7,0.5,0.1,0.4),
rgb(0.3,0.3,0.3,0.4)
)
# plot with default options:
radarchart(white_wines_best_worst,
axistype=1,
#custom polygon
pcol=colors_border,
pfcol=colors_in,
plwd=4,
plty=1,
#grid
cglcol="grey",
cglty=1,
axislabcol="grey",
#custom labels
vlcex=1
)
# Add a legend
legend(x=1,
y=1,
legend = rownames(white_wines_best_worst[-c(1,2),]),
bty = "n",
pch=20 ,
col=colors_in ,
text.col = "grey",
cex=1,
pt.cex=3)
> pairs.panels(all_wines,bg=c("yellow","blue"),pch=21,stars=TRUE)
pairs.panels(all_wines, bg=c("yellow","blue"),pch=21,stars=TRUE)
library(psych)
install.packages('psych')
library(psych)
install.packages('psych')
install.packages('mnormt')
updateR()
install.packages("installr")
install.packages('psych')
update.packages(checkBuilt=TRUE, ask=FALSE)
install.packages('psych')
update.packages(checkBuilt=TRUE, ask=FALSE)
install.packages("psych")
library(psych)
library(psych)
install.packages("psych")
